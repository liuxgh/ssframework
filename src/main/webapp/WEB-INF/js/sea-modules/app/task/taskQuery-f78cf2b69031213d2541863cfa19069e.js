define("app/task/taskQuery",["../common/jquery.pjax","../blui/ui-checkbox","gallery/jquery/jquery-1.10.2.min.js","gallery/My97DatePicker/WdatePicker.js","../common/message","gallery/template/template.min","../common/paging","../blui/ui-dropdown"],function(require,exports,module){require("../common/jquery.pjax");var Checkbox=require("../blui/ui-checkbox"),WdatePicker=require("gallery/My97DatePicker/WdatePicker.js"),Message=require("../common/message"),container="#task-table",url="/taskQueryTable",tableTemplateId="task-queryTable",Template=require("gallery/template/template.min"),Paging=require("../common/paging");exports.run=function(){getTable(),Checkbox.simple(".win-f-i-cb-item",function(){}),list(),$("body").delegate(".Wdate","focus",function(){WdatePicker({readOnly:!0})}),Message.show("案件：AJ-23231-20140908补正通知书到位")};var list=function(){var a=$(".t-table-item");a.hover(function(){$(this).addClass("selected")},function(){$(this).removeClass("selected")})},getTable=function(){var p=$(container).attr("data-pageIndex"),ps=$(container).attr("data-pageSize"),extendPage=5;$(container).load(url,{p:p,ps:ps},function(data){data=eval(data);var html=Template(tableTemplateId,data);$(container).html(html),Paging.show(p,ps,data.total,data.countPage,extendPage)})}}),define("app/common/jquery.pjax",["gallery/jquery/jquery-1.10.2.min.js"],function(a,b,c){a("gallery/jquery/jquery-1.10.2.min.js"),function(a){var b={support:{pjax:window.history&&window.history.pushState&&window.history.replaceState&&!navigator.userAgent.match(/(iPod|iPhone|iPad|WebApps\/.+CFNetwork)/),storage:!!window.localStorage},toInt:function(a){return parseInt(a)},stack:{},getTime:function(){return 1*new Date},getRealUrl:function(a){return a=(a||"").replace(/\#.*?$/,""),a=a.replace("?pjax=true&","?").replace("?pjax=true","").replace("&pjax=true","")},getUrlHash:function(a){return a.replace(/^[^\#]*(?:\#(.*?))?$/,"$1")},getLocalKey:function(a){var b="pjax_"+encodeURIComponent(a);return{data:b+"_data",time:b+"_time",title:b+"_title"}},removeAllCache:function(){if(b.support.storage)for(var a in localStorage)"pjax"===(a.split("_")||[""])[0]&&delete localStorage[a]},getCache:function(a,c,d){var e,f,g,h;if(c=b.toInt(c),a in b.stack){if(e=b.stack[a],ctime=b.getTime(),e.time+1e3*c>ctime)return e;delete b.stack[a]}else if(d&&b.support.storage){var i=b.getLocalKey(a);if(f=i.data,g=i.time,e=localStorage.getItem(f)){if(h=b.toInt(localStorage.getItem(g)),h+1e3*c>b.getTime())return{data:e,title:localStorage.getItem(i.title)};localStorage.removeItem(f),localStorage.removeItem(g),localStorage.removeItem(i.title)}}return null},setCache:function(a,c,d,e){var f,g=b.getTime();b.stack[a]={data:c,title:d,time:g},e&&b.support.storage&&(f=b.getLocalKey(a),localStorage.setItem(f.data,c),localStorage.setItem(f.time,g),localStorage.setItem(f.title,d))},removeCache:function(a){if(a=b.getRealUrl(a||location.href),delete b.stack[a],b.support.storage){var c=b.getLocalKey(a);localStorage.removeItem(c.data),localStorage.removeItem(c.time),localStorage.removeItem(c.title)}}},c=function(d){if(d=a.extend({selector:"",container:"",requestType:"",callback:function(){},filter:function(){},template:function(){}},d),!d.container||!d.selector)throw new Error("selector & container options must be set");"form"===d.requestType?a("body").delegate(d.selector,"submit",function(e){if(e.which>1||e.metaKey)return!0;var f=a(this),g=f.attr("action")+"?"+f.serialize();if("function"==typeof d.filter&&d.filter.call(this,g,this)===!0)return!0;if(g===location.href)return!0;if(b.getRealUrl(g)==b.getRealUrl(location.href)){var h=b.getUrlHash(g);return h&&(location.hash=h,d.callback&&d.callback.call(this,{type:"hash"})),!0}return e.preventDefault(),d=a.extend(!0,d,{url:g,element:this,title:"",push:!0}),c.request(d),!1}):a("body").delegate(d.selector,"click",function(e){if(e.which>1||e.metaKey)return!0;var f=a(this),g=f.attr("data-href");if("function"==typeof d.filter&&d.filter.call(this,g,this)===!0)return!0;if(g===location.href)return!0;if(b.getRealUrl(g)==b.getRealUrl(location.href)){var h=b.getUrlHash(g);return h&&(location.hash=h,d.callback&&d.callback.call(this,{type:"hash"})),!0}e.preventDefault(),d=a.extend(!0,d,{url:g,element:this,title:"",push:!0}),c.request(d)})};c.xhr=null,c.options={},c.state={},c.defaultOptions={timeout:2e3,element:null,cache:86400,storage:!0,url:"",push:!0,show:"",title:"",titleSuffix:"",type:"GET",data:{pjax:!0},dataType:"html",callback:null,beforeSend:function(b){a(c.options.container).trigger("pjax.start",[b,c.options]),b&&b.setRequestHeader("X-PJAX",!0)},error:function(){c.options.callback&&c.options.callback.call(c.options.element,{type:"error"}),location.href=c.options.url},complete:function(b){a(c.options.container).trigger("pjax.end",[b,c.options])}},c.showFx={_default:function(a,b,d){this.html(c.template(a)),b&&b.call(this,a,d)},fade:function(a,b,d){var e=this;d?(e.html(c.template(a)),b&&b.call(e,a,d)):this.fadeOut(500,function(){e.html(c.template(a)).fadeIn(500,function(){b&&b.call(e,a,d)})})}},c.showFn=function(b,d,e,f,g){var h=null;"function"==typeof b?h=b:(b in c.showFx||(b="_default"),h=c.showFx[b]),h&&h.call(d,e,function(){var b=location.hash;""!=b?(location.href=b,/Firefox/.test(navigator.userAgent)&&history.replaceState(a.extend({},c.state,{url:null}),document.title)):window.scrollTo(0,0),f&&f.call(this,e,g)},g)},c.success=function(d,e){if(e!==!0&&(e=!1),c.html&&(d=a(d).find(c.html).html()),-1!=(d||"").indexOf("<html"))return c.options.callback&&c.options.callback.call(c.options.element,{type:"error"}),location.href=c.options.url,!1;var f,g=c.options.title||"";c.options.element&&(f=a(c.options.element),g=f.attr("title")||f.text());var h=d.match(/<title>(.*?)<\/title>/);h&&(g=h[1]),g&&-1==g.indexOf(c.options.titleSuffix)&&(g+=c.options.titleSuffix),document.title=c.options.titleSuffix,c.state={container:c.options.container,timeout:c.options.timeout,cache:c.options.cache,storage:c.options.storage,show:c.options.show,title:g,url:c.options.oldUrl};var i=a.param(c.options.data);""!=i&&(c.state.url=c.options.url+(/\?/.test(c.options.url)?"&":"?")+i),c.options.push?(c.active||(history.replaceState(a.extend({},c.state,{url:null}),document.title),c.active=!0),history.pushState(c.state,document.title,c.options.oldUrl)):c.options.push===!1&&history.replaceState(c.state,document.title,c.options.oldUrl),c.options.showFn&&c.options.showFn(d,function(){c.options.callback&&c.options.callback.call(c.options.element,{type:e?"cache":"success"})},e),c.options.cache&&!e&&b.setCache(c.options.url,d,g,c.options.storage)},c.request=function(d){d=a.extend(!0,c.defaultOptions,d);var e,f=a(d.container);return d.oldUrl=d.url,d.url=b.getRealUrl(d.url),a(d.element).length&&(e=b.toInt(a(d.element).attr("data-pjax-cache")),e&&(d.cache=e)),d.cache===!0&&(d.cache=86400),d.cache=b.toInt(d.cache),0===d.cache&&b.removeAllCache(),d.showFn||(d.showFn=function(a,b,e){c.showFn(d.show,f,a,b,e)}),c.options=d,c.options.success=c.success,d.cache&&(e=b.getCache(d.url,d.cache,d.storage))?(d.beforeSend(),d.title=e.title,c.success(e.data,!0),d.complete(),!0):(c.xhr&&c.xhr.readyState<4&&(c.xhr.onreadystatechange=a.noop,c.xhr.abort()),void(c.xhr=a.ajax(c.options)))},c.template=function(a){c.options.template(a,c.options.container)};var d="state"in window.history,e=location.href;a(window).bind("popstate",function(b){var f=!d&&location.href==e;if(d=!0,!f){var g=b.state;if(g&&g.container)if(a(g.container).length){var h={url:g.url,container:g.container,push:null,timeout:g.timeout,cache:g.cache,storage:g.storage,title:g.title,element:null};c.request(h)}else window.location=location.href}}),b.support.pjax||(c=function(){return!0},c.request=function(a){a&&a.url&&(location.href=a.url)}),a.pjax=c,a.pjax.util=b,a.inArray("state",a.event.props)<0&&a.event.props.push("state")}(jQuery),c.exports=$}),define("app/blui/ui-checkbox",["gallery/jquery/jquery-1.10.2.min.js"],function(a,b){a("gallery/jquery/jquery-1.10.2.min.js"),b.simple=function(a,b){$("body").delegate(a,"click",function(){$(this).hasClass("selected")?$(this).removeClass("selected"):$(this).addClass("selected"),"function"==typeof b&&b($(this))})}}),define("app/common/message",["gallery/jquery/jquery-1.10.2.min.js","gallery/template/template.min"],function(a,b){a("gallery/jquery/jquery-1.10.2.min.js");var c="common-message",d=a("gallery/template/template.min"),e=3e3;b.show=function(a){var b="#message";$(b).remove();var g={message:a};$("body").append(d(c,g)),$("body").delegate(".mes-closeBtn","click",function(){$(b).remove()}),$("body").delegate(b,"mouseover",function(){clearInterval(f),$(b).stop(!0).css({opacity:1})}),$("body").delegate(b,"mouseout",function(){f=setInterval(function(){$(b).fadeOut(e)},1e4)})};var f=setInterval(function(){$("#message").fadeOut(e)},1e4)}),define("app/common/paging",["app/common/jquery.pjax","gallery/template/template.min","app/blui/ui-dropdown","gallery/jquery/jquery-1.10.2.min.js"],function(require,exports,module){require("app/common/jquery.pjax");var pagingTemplateId="common-paging",tableTemplateId="task-queryTable",Template=require("gallery/template/template.min"),pagingObj=".paging-demo",pageIndexObj=$("#pageIndex"),fromObj="#searchForm",numVal=/^\d{1,4}$/,pageBtn=".paging-num a,.paging-prev,.paging-next",pageInputIndex=".paging-inputNum input",UIDropdown=require("app/blui/ui-dropdown"),container="#task-table";exports.show=function(a,b,c,d,e){showPaging(a,b,c,d,e),run()};var showPaging=function(a,b,c,d,e){var f={p:a,ps:b,total:c,countPage:d,extendPage:e},g=Template(pagingTemplateId,f);$(pagingObj).html(g)},run=function(){$.pjax({selector:fromObj,container:container,requestType:"form",show:"_default",cache:!1,storage:!1,titleSuffix:"任务查询 - 业务系统管理平台",filter:function(){},callback:function(){},template:function(data,element){data=eval(data);var dataHtml=Template(tableTemplateId,data);$(element).html(dataHtml),showPaging(data.p,data.ps,data.total,data.countPage,5)}}),$(container).bind("pjax.start",function(){$(container).html("<img src='/images/blui/loading.gif'/>")}),UIDropdown.dropdownList(),$("body").delegate(pageBtn,"click",function(){var a=$.trim($(this).attr("data-pageIndex")),b=$(this).hasClass("paging-disable")||$(this).hasClass("paging-n-current");b||(pageIndexObj.val(a),$(fromObj).submit())}),$("body").delegate(pageInputIndex,"keypress",function(a){if("13"==a.keyCode){var b=$.trim($(".paging-totalCount em").text()),c=$.trim($(".paging-n-current").attr("data-pageIndex")),d=$.trim($(this).val());if(!numVal.test(d))return alert("请输入数字"),!1;if(1>d/1||d/1>b/1)return alert("页码超出范围"),!1;c!=d&&(pageIndexObj.val(d),$(fromObj).submit())}}),$("body").delegate(".paging a.d-m-item","click",function(){var a=$.trim($(this).text());$(this).parents(".dropdown").find(".btn").html(a+"<span class='caret'></span>"),$("#pageSize").val(a),pageIndexObj.val(1),$(fromObj).submit()})}}),define("app/blui/ui-dropdown",["gallery/jquery/jquery-1.10.2.min.js"],function(a,b){a("gallery/jquery/jquery-1.10.2.min.js");var c=$("body"),d=$(".dropdown ul"),e="<span class='caret'></span>";b.dropdownList=function(){c.delegate(".dropdown","click",function(a){var b=window.event||a;b.stopPropagation?b.stopPropagation():b.cancelBubble=!0,$(".open").removeClass("open"),$(this).toggleClass("open"),$(".f-select").css({"z-index":"2"}),$(this).parents(".f-select").css($(this).hasClass("open")?{"z-index":"3"}:{"z-index":"2"}),"d-m-item"==a.target.className&&$(".open").removeClass("open")}),$(document).click(function(){$(".open").removeClass("open")}),d.find("li").click(function(){var a=$(this).parents(".dropdown").find(".btn"),b=$.trim($(this).find("a").text());a.html(b+e);var c=$.trim($(this).find("a").attr("data-id")),d=$(this).parents(".dropdown").parent().find(".dropdown-input");""!=c&&d.next().hasClass("error")&&d.next().remove(),d.val(c)})}});
